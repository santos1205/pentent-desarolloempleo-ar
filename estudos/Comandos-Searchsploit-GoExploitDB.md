# Guia de Comandos: searchsploit e go-exploitdb

Este documento apresenta os principais comandos e exemplos de uso das ferramentas **searchsploit** e **go-exploitdb** para busca de exploits públicos.

---

## Índice

### 1. searchsploit (Exploit-DB Command Line Search Tool)
- [Instalação](#instalação)
- [Uso via Docker (reedcrif/searchsploit)](#uso-via-docker-reedcrifsearchsploit)
- [Configuração e Uso com Docker + Volume](#configuração-e-uso-com-docker--volume)
- [Comandos Básicos](#comandos-básicos)
  - [Busca Simples](#busca-simples)
  - [Atualização da Base de Dados](#atualização-da-base-de-dados)
  - [Ajuda](#ajuda)
- [Filtros e Refinamentos](#filtros-e-refinamentos)
  - [Busca no Título Apenas](#busca-no-título-apenas)
  - [Busca Case-Sensitive](#busca-case-sensitive)
  - [Busca Exata](#busca-exata)
  - [Excluir Termos](#excluir-termos)
- [Visualização e Manipulação de Exploits](#visualização-e-manipulação-de-exploits)
  - [Mostrar Caminho do Exploit](#mostrar-caminho-do-exploit)
  - [Copiar Exploit para Diretório Atual](#copiar-exploit-para-diretório-atual)
  - [Examinar Conteúdo do Exploit](#examinar-conteúdo-do-exploit)
  - [Abrir no Navegador (Exploit-DB)](#abrir-no-navegador-exploit-db)
- [Formato de Saída](#formato-de-saída)
  - [Saída em JSON](#saída-em-json)
- [Exemplos Práticos](#exemplos-práticos)
  - [Exemplo 1: Buscar Exploits para WordPress](#exemplo-1-buscar-exploits-para-wordpress)
  - [Exemplo 2: Buscar por CVE](#exemplo-2-buscar-por-cve)
  - [Exemplo 3: Workflow Completo](#exemplo-3-workflow-completo)
  - [Exemplo 4: Busca Avançada](#exemplo-4-busca-avançada)
- [Limitações Conhecidas](#limitações-conhecidas)

### 2. go-exploitdb (Vuls Exploit Database Tool)
- [Instalação](#instalação-1)
- [Configuração do Banco de Dados](#configuração-do-banco-de-dados)
- [Comandos de Fetch (Download de Dados)](#comandos-de-fetch-download-de-dados)
  - [Buscar da Exploit-DB](#buscar-da-exploit-db)
  - [Buscar do GitHub](#buscar-do-github)
  - [Buscar de Múltiplas Fontes](#buscar-de-múltiplas-fontes)
- [Comandos de Busca](#comandos-de-busca)
  - [Buscar por CVE](#buscar-por-cve)
  - [Buscar por ID do Exploit-DB](#buscar-por-id-do-exploit-db)
  - [Buscar por Palavra-chave](#buscar-por-palavra-chave)
- [Servidor HTTP (API)](#servidor-http-api)
  - [Iniciar Servidor](#iniciar-servidor)
  - [Usar API via HTTP](#usar-api-via-http)
- [Uso via Docker](#uso-via-docker)
- [Opções Globais](#opções-globais)
- [Exemplos Práticos](#exemplos-práticos-1)
  - [Exemplo 1: Setup Inicial](#exemplo-1-setup-inicial)
  - [Exemplo 2: Integração com Vuls](#exemplo-2-integração-com-vuls)
  - [Exemplo 3: Servidor API](#exemplo-3-servidor-api)
  - [Exemplo 4: Busca Automatizada](#exemplo-4-busca-automatizada)
- [Atualização Regular](#atualização-regular)

### Seções Gerais
- [Comparação: searchsploit vs go-exploitdb](#comparação-searchsploit-vs-go-exploitdb)
- [Casos de Uso Recomendados](#casos-de-uso-recomendados)
- [Referências](#referências)
- [Aviso Legal](#aviso-legal)

---

## 1. searchsploit (Exploit-DB Command Line Search Tool)

Ferramenta de linha de comando para buscar exploits na base de dados Exploit-DB local.

### Instalação

```bash
# Kali Linux (já vem instalado)
# Verificar instalação
searchsploit --version

# Instalar no Ubuntu/Debian
sudo apt update
sudo apt install exploitdb

# Atualizar base de dados
searchsploit -u
```

### Uso via Docker (reedcrif/searchsploit)

```bash
# Busca básica
docker run --rm reedcrif/searchsploit:latest searchsploit wordpress

# Busca com versão específica
docker run --rm reedcrif/searchsploit:latest searchsploit wordpress 6.8

# Busca com múltiplas palavras (usar aspas)
docker run --rm reedcrif/searchsploit:latest searchsploit "elementor pro"
```

### Configuração e Uso com Docker + Volume

Esta seção apresenta o setup completo do searchsploit usando Docker com volume persistente para manter o banco de dados atualizado no host local.

#### Por que usar Volume?

- ✅ **Persistência:** O banco de dados fica salvo no host, não se perde ao remover o container
- ✅ **Atualização:** Você atualiza uma vez e todos os containers futuros usam a mesma base
- ✅ **Performance:** Evita baixar o banco toda vez que usar
- ✅ **Compartilhamento:** Múltiplos containers podem usar o mesmo banco

#### Setup Inicial

```bash
# 1. Criar diretório para o banco de dados
mkdir -p ~/exploitdb

# 2. Baixar a imagem Docker
docker pull reedcrif/searchsploit:latest

# 3. Fazer download inicial do banco de dados
# O volume será montado em /opt/exploitdb dentro do container
docker run --rm \
  -v ~/exploitdb:/opt/exploitdb \
  reedcrif/searchsploit:latest \
  searchsploit -u

# Isso pode demorar alguns minutos na primeira vez
```

#### Atualização do Banco de Dados

```bash
# Atualizar o banco de dados (recomendado fazer periodicamente)
docker run --rm \
  -v ~/exploitdb:/opt/exploitdb \
  reedcrif/searchsploit:latest \
  searchsploit -u

# Verificar última atualização
docker run --rm \
  -v ~/exploitdb:/opt/exploitdb \
  reedcrif/searchsploit:latest \
  ls -lh /opt/exploitdb/files_exploits.csv
```

#### Uso Prático com Volume

```bash
# Busca básica (usa o banco persistente)
docker run --rm \
  -v ~/exploitdb:/opt/exploitdb \
  reedcrif/searchsploit:latest \
  searchsploit wordpress

# Buscar por CVE
docker run --rm \
  -v ~/exploitdb:/opt/exploitdb \
  reedcrif/searchsploit:latest \
  searchsploit --cve CVE-2021-34527

# Buscar e copiar exploit para diretório atual
# Nota: exploits copiados vão para o diretório de trabalho do container
docker run --rm \
  -v ~/exploitdb:/opt/exploitdb \
  -v $(pwd):/workspace \
  -w /workspace \
  reedcrif/searchsploit:latest \
  searchsploit -m 40905

# Visualizar exploit
docker run --rm \
  -v ~/exploitdb:/opt/exploitdb \
  reedcrif/searchsploit:latest \
  searchsploit -x 40905
```

#### Criar Alias para Facilidade de Uso

Adicione ao seu `~/.bashrc` ou `~/.zshrc`:

```bash
# Alias para searchsploit com Docker + Volume
alias searchsploit='docker run --rm -v ~/exploitdb:/opt/exploitdb reedcrif/searchsploit:latest searchsploit'

# Alias para atualizar o banco
alias searchsploit-update='docker run --rm -v ~/exploitdb:/opt/exploitdb reedcrif/searchsploit:latest searchsploit -u'
```

Após adicionar, recarregue o shell:
```bash
source ~/.bashrc  # ou source ~/.zshrc
```

Agora você pode usar normalmente:
```bash
# Buscar
searchsploit wordpress

# Atualizar banco
searchsploit-update
```

#### Script Helper (Opcional)

Crie um script `~/bin/searchsploit-docker.sh`:

```bash
#!/bin/bash
# Script helper para searchsploit com Docker

EXPLOITDB_DIR="$HOME/exploitdb"
IMAGE="reedcrif/searchsploit:latest"

# Criar diretório se não existir
mkdir -p "$EXPLOITDB_DIR"

# Se primeiro argumento for "update", atualizar banco
if [ "$1" = "update" ]; then
    echo "Atualizando banco de dados Exploit-DB..."
    docker run --rm \
        -v "$EXPLOITDB_DIR:/opt/exploitdb" \
        "$IMAGE" \
        searchsploit -u
    exit 0
fi

# Caso contrário, executar busca normal
docker run --rm \
    -v "$EXPLOITDB_DIR:/opt/exploitdb" \
    "$IMAGE" \
    searchsploit "$@"
```

Tornar executável e usar:
```bash
chmod +x ~/bin/searchsploit-docker.sh

# Buscar
~/bin/searchsploit-docker.sh wordpress

# Atualizar
~/bin/searchsploit-docker.sh update
```

#### Verificar Tamanho do Banco de Dados

```bash
# Ver tamanho do diretório do banco
du -sh ~/exploitdb

# Listar arquivos principais
ls -lh ~/exploitdb/
```

#### Manutenção e Limpeza

```bash
# Remover banco antigo e baixar novamente (se necessário)
rm -rf ~/exploitdb
mkdir -p ~/exploitdb
docker run --rm \
  -v ~/exploitdb:/opt/exploitdb \
  reedcrif/searchsploit:latest \
  searchsploit -u

# Verificar integridade do banco
docker run --rm \
  -v ~/exploitdb:/opt/exploitdb \
  reedcrif/searchsploit:latest \
  searchsploit --help
```

#### Atualização Automática (Cron)

Para atualizar automaticamente o banco periodicamente, adicione ao crontab:

```bash
# Editar crontab
crontab -e

# Adicionar linha para atualizar diariamente às 2h da manhã
0 2 * * * docker run --rm -v ~/exploitdb:/opt/exploitdb reedcrif/searchsploit:latest searchsploit -u > /dev/null 2>&1
```

#### Workflow Completo com Volume

```bash
# 1. Setup inicial (uma vez)
mkdir -p ~/exploitdb
docker pull reedcrif/searchsploit:latest
docker run --rm -v ~/exploitdb:/opt/exploitdb reedcrif/searchsploit:latest searchsploit -u

# 2. Buscar exploits
docker run --rm -v ~/exploitdb:/opt/exploitdb reedcrif/searchsploit:latest searchsploit wordpress

# 3. Ver detalhes de um exploit
docker run --rm -v ~/exploitdb:/opt/exploitdb reedcrif/searchsploit:latest searchsploit -x 40905

# 4. Copiar exploit para análise (com volume adicional para workspace)
docker run --rm \
  -v ~/exploitdb:/opt/exploitdb \
  -v $(pwd):/workspace \
  -w /workspace \
  reedcrif/searchsploit:latest \
  searchsploit -m 40905

# 5. Atualizar banco periodicamente (semanal recomendado)
docker run --rm -v ~/exploitdb:/opt/exploitdb reedcrif/searchsploit:latest searchsploit -u
```

#### Troubleshooting

```bash
# Problema: Container não encontra o banco
# Solução: Verificar se o volume está montado corretamente
docker run --rm -v ~/exploitdb:/opt/exploitdb reedcrif/searchsploit:latest ls -la /opt/exploitdb

# Problema: Permissões negadas
# Solução: Ajustar permissões do diretório
chmod -R 755 ~/exploitdb

# Problema: Banco desatualizado
# Solução: Forçar atualização
docker run --rm -v ~/exploitdb:/opt/exploitdb reedcrif/searchsploit:latest searchsploit -u
```

### Comandos Básicos

#### Busca Simples
```bash
# Buscar por termo
searchsploit wordpress

# Buscar por produto e versão
searchsploit apache 2.4

# Buscar por CVE específico
searchsploit --cve CVE-2021-34527

# Buscar por ID do Exploit-DB
searchsploit --id 40905
```

#### Atualização da Base de Dados
```bash
# Atualizar base de dados local
searchsploit -u
# ou
searchsploit --update
```

#### Ajuda
```bash
# Ver ajuda completa
searchsploit -h
# ou
searchsploit --help
```

### Filtros e Refinamentos

#### Busca no Título Apenas
```bash
# Buscar apenas no título (ignora caminho do arquivo)
searchsploit -t wordpress
# ou
searchsploit --title wordpress
```

#### Busca Case-Sensitive
```bash
# Busca sensível a maiúsculas/minúsculas
searchsploit -c WordPress
# ou
searchsploit --case WordPress
```

#### Busca Exata
```bash
# Busca por correspondência exata
searchsploit -e "WordPress 6.8 Remote Code Execution"
# ou
searchsploit --exact "WordPress 6.8 Remote Code Execution"
```

#### Excluir Termos
```bash
# Excluir resultados que contenham "dos" ou "poc"
searchsploit linux kernel --exclude="dos|poc"

# Excluir múltiplos termos
searchsploit apache --exclude="dos|denial"
```

### Visualização e Manipulação de Exploits

#### Mostrar Caminho do Exploit
```bash
# Mostrar caminho completo do exploit
searchsploit -p 40905
# ou
searchsploit -p exploits/php/webapps/40905.txt

# Copia para clipboard automaticamente (se suportado)
```

#### Copiar Exploit para Diretório Atual
```bash
# Copiar exploit por ID
searchsploit -m 40905

# Copiar exploit por caminho
searchsploit -m exploits/php/webapps/40905.txt
```

#### Examinar Conteúdo do Exploit
```bash
# Visualizar conteúdo do exploit (abre com pager)
searchsploit -x 40905

# Visualizar por caminho
searchsploit -x exploits/php/webapps/40905.txt
```

#### Abrir no Navegador (Exploit-DB)
```bash
# Mostrar URL do exploit no site Exploit-DB
searchsploit -w wordpress
# ou
searchsploit --www wordpress

# Abrir exploit específico
searchsploit -w 40905
```

### Formato de Saída

#### Saída em JSON
```bash
# Formatar saída como JSON (útil para scripts)
searchsploit --json wordpress

# Exemplo de uso em script
searchsploit --json wordpress | jq '.[] | select(.Title | contains("RCE"))'
```

### Exemplos Práticos

#### Exemplo 1: Buscar Exploits para WordPress
```bash
# Busca geral
searchsploit wordpress

# Busca específica por versão
searchsploit wordpress 6.8

# Busca no título apenas
searchsploit -t wordpress

# Excluir DoS e PoCs
searchsploit wordpress --exclude="dos|poc"
```

#### Exemplo 2: Buscar por CVE
```bash
# Buscar exploit para CVE específico
searchsploit --cve CVE-2019-8942

# Buscar e copiar para diretório atual
searchsploit --cve CVE-2019-8942 -m
```

#### Exemplo 3: Workflow Completo
```bash
# 1. Buscar exploits
searchsploit wordpress xmlrpc

# 2. Ver detalhes de um exploit específico
searchsploit -x 40905

# 3. Copiar exploit para análise
searchsploit -m 40905

# 4. Abrir no navegador para mais informações
searchsploit -w 40905
```

#### Exemplo 4: Busca Avançada
```bash
# Buscar exploits de RCE no WordPress, excluindo DoS
searchsploit wordpress rce --exclude="dos|denial"

# Buscar apenas no título, case-sensitive
searchsploit -t -c "WordPress RCE"

# Buscar e exportar em JSON
searchsploit --json wordpress > wordpress_exploits.json
```

### Limitações Conhecidas

- **Base de dados desatualizada:** A imagem Docker `reedcrif/searchsploit` está desatualizada (~6 anos)
- **Atualização lenta:** O comando `searchsploit -u` pode demorar muito
- **Cobertura limitada:** Não cobre todos os exploits, apenas os publicados no Exploit-DB

---

## 2. go-exploitdb (Vuls Exploit Database Tool)

Ferramenta em Go para buscar e gerenciar exploits de múltiplas fontes (Exploit-DB, GitHub, etc.), com suporte a banco de dados local e API.

### Instalação

```bash
# Instalar via Go
go install github.com/vulsio/go-exploitdb/cmd/go-exploitdb@latest

# Ou baixar binário pré-compilado
# https://github.com/vulsio/go-exploitdb/releases

# Ou usar Docker
docker pull vuls/go-exploitdb:latest
```

### Configuração do Banco de Dados

```bash
# Usar SQLite (padrão)
go-exploitdb fetch exploitdb --dbpath ./exploitdb.sqlite3

# Usar MySQL
go-exploitdb fetch exploitdb --dbtype mysql --dbpath "user:pass@tcp(localhost:3306)/exploitdb"

# Usar PostgreSQL
go-exploitdb fetch exploitdb --dbtype postgres --dbpath "host=localhost user=user dbname=exploitdb sslmode=disable"

# Usar Redis
go-exploitdb fetch exploitdb --dbtype redis --dbpath "redis://localhost:6379/0"
```

### Comandos de Fetch (Download de Dados)

#### Buscar da Exploit-DB
```bash
# Buscar exploits da Exploit-DB
go-exploitdb fetch exploitdb

# Especificar caminho do banco
go-exploitdb fetch exploitdb --dbpath ./exploitdb.sqlite3
```

#### Buscar do GitHub
```bash
# Buscar exploits do GitHub (mais lento)
go-exploitdb fetch github

# Busca profunda (extrai CVEs também)
go-exploitdb fetch github --deep
```

#### Buscar de Múltiplas Fontes
```bash
# Buscar de todas as fontes disponíveis
go-exploitdb fetch exploitdb
go-exploitdb fetch github
go-exploitdb fetch awesomepoc
go-exploitdb fetch inthewild
```

### Comandos de Busca

#### Buscar por CVE
```bash
# Buscar exploit por CVE
go-exploitdb search --type CVE --param CVE-2021-34527

# Com banco de dados específico
go-exploitdb search --type CVE --param CVE-2021-34527 --dbpath ./exploitdb.sqlite3
```

#### Buscar por ID do Exploit-DB
```bash
# Buscar por EDB-ID
go-exploitdb search --type ID --param 40905

# Buscar múltiplos IDs
go-exploitdb search --type ID --param "40905,40939,41497"
```

#### Buscar por Palavra-chave
```bash
# Buscar por termo (se suportado pela versão)
go-exploitdb search wordpress

# Buscar com filtros
go-exploitdb search --type CVE --param CVE-2019 --dbpath ./exploitdb.sqlite3
```

### Servidor HTTP (API)

#### Iniciar Servidor
```bash
# Iniciar servidor HTTP na porta padrão (1325)
go-exploitdb server

# Especificar porta
go-exploitdb server --port 8080

# Com banco de dados específico
go-exploitdb server --dbpath ./exploitdb.sqlite3
```

#### Usar API via HTTP
```bash
# Buscar por CVE via API
curl "http://localhost:1325/cves/CVE-2021-34527"

# Buscar por ID via API
curl "http://localhost:1325/exploits/40905"

# Listar todos os exploits
curl "http://localhost:1325/exploits"
```

### Uso via Docker

```bash
# Buscar exploits da Exploit-DB
docker run --rm -v $(pwd):/vuls vuls/go-exploitdb:latest fetch exploitdb

# Buscar por CVE
docker run --rm -v $(pwd):/vuls vuls/go-exploitdb:latest search --type CVE --param CVE-2021-34527

# Iniciar servidor
docker run --rm -p 1325:1325 -v $(pwd):/vuls vuls/go-exploitdb:latest server
```

### Opções Globais

```bash
# Especificar caminho do banco de dados
--dbpath <caminho>          # Caminho ou string de conexão
--dbtype <tipo>             # sqlite3, mysql, postgres, redis

# Logging e Debug
--debug                     # Modo debug
--debug-sql                 # Debug de queries SQL
--log-dir <diretório>       # Diretório para logs
--log-json                  # Logs em formato JSON
--quiet                     # Modo silencioso

# Proxy
--http-proxy <url>          # Proxy HTTP

# Ajuda
-h, --help                  # Mostrar ajuda
```

### Exemplos Práticos

#### Exemplo 1: Setup Inicial
```bash
# 1. Criar banco de dados e buscar exploits
go-exploitdb fetch exploitdb --dbpath ./exploitdb.sqlite3

# 2. Verificar dados
go-exploitdb search --type CVE --param CVE-2019-8942 --dbpath ./exploitdb.sqlite3
```

#### Exemplo 2: Integração com Vuls
```bash
# go-exploitdb é usado automaticamente pelo Vuls
# Mas você pode buscar manualmente:

# Buscar exploits para CVEs encontrados pelo Vuls
go-exploitdb search --type CVE --param CVE-2021-24284 --dbpath ./exploitdb.sqlite3
```

#### Exemplo 3: Servidor API
```bash
# 1. Iniciar servidor
go-exploitdb server --dbpath ./exploitdb.sqlite3 --port 8080

# 2. Consultar via curl
curl "http://localhost:8080/cves/CVE-2021-34527"

# 3. Integrar com scripts
python3 << EOF
import requests
response = requests.get("http://localhost:8080/cves/CVE-2021-34527")
print(response.json())
EOF
```

#### Exemplo 4: Busca Automatizada
```bash
#!/bin/bash
# Script para buscar exploits de múltiplos CVEs

CVES=("CVE-2019-8942" "CVE-2019-9787" "CVE-2018-6389")

for cve in "${CVES[@]}"; do
    echo "Buscando exploits para $cve..."
    go-exploitdb search --type CVE --param "$cve" --dbpath ./exploitdb.sqlite3
    echo "---"
done
```

### Atualização Regular

```bash
# Atualizar base de dados periodicamente
# Adicionar ao crontab para atualização diária
0 2 * * * /usr/local/bin/go-exploitdb fetch exploitdb --dbpath /var/lib/exploitdb/exploitdb.sqlite3
```

---

## Comparação: searchsploit vs go-exploitdb

| Característica | searchsploit | go-exploitdb |
|----------------|--------------|--------------|
| **Tipo** | CLI standalone | CLI + API Server |
| **Banco de Dados** | Arquivos locais | SQLite/MySQL/Postgres/Redis |
| **Fontes** | Apenas Exploit-DB | Exploit-DB, GitHub, AwesomePoc, inTheWild |
| **Busca por CVE** | ✅ `--cve` | ✅ `--type CVE` |
| **Busca por ID** | ✅ `--id` | ✅ `--type ID` |
| **API HTTP** | ❌ | ✅ `server` |
| **Integração** | Manual | Automatizada (Vuls) |
| **Atualização** | `-u` | `fetch <fonte>` |
| **Formato JSON** | ✅ `--json` | ✅ (via API) |

---

## Casos de Uso Recomendados

### Use searchsploit quando:
- ✅ Precisa de busca rápida e simples
- ✅ Trabalha manualmente em testes de penetração
- ✅ Quer examinar exploits rapidamente
- ✅ Precisa copiar exploits para análise local

### Use go-exploitdb quando:
- ✅ Precisa integrar com ferramentas automatizadas (Vuls)
- ✅ Quer API HTTP para integração
- ✅ Precisa de múltiplas fontes de exploits
- ✅ Quer banco de dados estruturado (SQL)
- ✅ Precisa de busca programática

---

## Referências

- **Exploit-DB:** https://www.exploit-db.com/
- **searchsploit GitHub:** https://github.com/offensive-security/exploitdb
- **go-exploitdb GitHub:** https://github.com/vulsio/go-exploitdb
- **Vuls GitHub:** https://github.com/future-architect/vuls

---

## Aviso Legal

Estas ferramentas devem ser usadas **apenas para fins legítimos**:
- Testes de penetração autorizados
- Pesquisa de segurança
- Análise de vulnerabilidades em sistemas próprios
- Educação e treinamento em segurança

**Nunca use estas ferramentas em sistemas sem autorização explícita.**
